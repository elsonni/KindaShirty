<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Secure Checkout | KindaShirty</title>

  <link rel="stylesheet" href="/css/style.css"/>
  <link rel="preconnect" href="https://rsms.me" crossorigin>
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css"/>
  <script src="https://web.squarecdn.com/v1/square.js" type="text/javascript"></script>

  <style>
    :root {
      --square-blue: #006aff;
      --gray-light: #f5f7f9;
      --gray-border: #e1e4e8;
      --font-primary: 'Inter', sans-serif;
      --ok: #16a34a;
    }
    body { font-family: var(--font-primary); background: var(--gray-light); color: #111; margin: 0; }
    .checkout-container { max-width: 800px; margin: 4rem auto; padding: 2rem; background: #fff; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
    .checkout-container h1, h2 { font-weight: 700; color: #111; }
    .checkout-container label { display: block; margin-top: 1rem; font-weight: 600; }
    .checkout-container input, .checkout-container select {
      width: 100%; padding: 0.75rem; margin-top: 0.25rem; border: 1px solid var(--gray-border);
      border-radius: 6px; font-family: var(--font-primary); font-size: 1.05rem;
    }

    /* existing summary styling for mobile */
    #summary { margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #ddd; }
    #summary p { margin: 0.25rem 0; }
    #card-container { margin-top: 2rem; }

    #pay-button {
      margin-top: 2rem; width: 100%; padding: 0.75rem; background: var(--square-blue); color: #fff; font-size: 1rem;
      font-weight: 600; text-transform: uppercase; border: none; border-radius: 6px; cursor: pointer; transition: background .3s ease;
    }
    #pay-button:hover { background: #0051cc; }
    #pay-button[disabled] { opacity: .7; cursor: not-allowed; }

    #status { margin-top: 1rem; color: red; }
    .square-footer { margin-top: 2rem; font-size: .875rem; text-align: center; color: #555; }
    .square-footer p { margin-top: 1rem; }
    .square-footer a { color: var(--square-blue); text-decoration: underline; }
    .promo-row { display:flex; gap:.5rem; align-items:center; margin-top: .75rem; }
    .promo-row input { flex: 1 1 auto; }

    .checkout-container input.invalid, .checkout-container select.invalid { border-color: #ef4444 !important; }

    /* === Progress overlay with step badges (unchanged) === */
    .busy-overlay { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(17,17,17,0.45); z-index: 9999; }
    .busy-overlay[hidden] { display: none !important; }
    .busy-box { width: min(92vw, 520px); background: #fff; padding: 16px 18px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,.18); }
    .busy-head { display:flex; align-items:center; gap:12px; font-weight:700; margin-bottom:10px; }
    .spinner { width: 20px; height: 20px; border-radius: 50%; border: 3px solid #e5e7eb; border-top-color: var(--square-blue); animation: spin .8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .steps { display:flex; flex-direction:column; gap:8px; margin-top:6px; }
    .step { display:flex; align-items:center; gap:10px; font-weight:600; }
    .dot { width: 12px; height: 12px; border-radius: 50%; background: #e5e7eb; border: 1px solid #e5e7eb; flex: 0 0 12px; }
    .step.is-current .dot { background: var(--square-blue); border-color: var(--square-blue); animation: pulse 1.2s ease-in-out infinite; }
    .step.is-done .dot { background: var(--ok); border-color: var(--ok); }
    .step .txt { color: #111; }
    @keyframes pulse { 0%,100%{ transform: scale(1) } 50%{ transform: scale(1.2) } }

    /* === NEW: desktop two-column grid + sticky summary === */
    @media (min-width: 900px) {
      #checkout-form.checkout-grid {
        display: grid;
        grid-template-columns: minmax(0, 1fr) 360px; /* left | right */
        gap: 24px 28px;
        align-items: start;
      }
      #checkout-form.checkout-grid > .checkout-main { grid-column: 1; }
      #checkout-form.checkout-grid > #summary {
        grid-column: 2;
        grid-row: 1 / span 999;
        position: sticky;
        top: 14px;
        /* card look overrides the mobile divider */
        margin-top: 0;
        border-top: 0;
        background: #fff;
        border: 1px solid var(--gray-border);
        border-radius: 10px;
        padding: 16px;
        box-shadow: 0 2px 10px rgba(0,0,0,.04);
      }
    }
  </style>
</head>
<body>
   <div style="text-align:center; margin-top:2rem;">
    <img src="img/logos/checkout.png" alt="KindaShirty Logo" style="height:200px; max-width:200px;"/>
  </div>

  <div class="checkout-container">
    <h1 class="page-title">Secure Checkout</h1>

    <!-- âœ… add 'checkout-grid' -->
    <form id="checkout-form" class="checkout-grid" novalidate>
      <!-- âœ… add 'checkout-main' to the left column wrapper -->
      <div class="checkout-main">
        <h2>Contact</h2>
        <label>Email
          <input type="email" name="email" autocomplete="email" autocapitalize="none" spellcheck="false" required />
        </label>

        <h2>Delivery</h2>
        <label>First name
          <input type="text" name="firstName" autocomplete="given-name" />
        </label>
        <label>Last name
          <input type="text" name="name" autocomplete="family-name" required />
        </label>
        <label>Company (optional)
          <input type="text" name="company" autocomplete="organization" />
        </label>
        <label>Address
          <input type="text" name="address" autocomplete="address-line1" required />
        </label>
        <label>Apartment, suite, etc. (optional)
          <input type="text" name="address2" autocomplete="address-line2" />
        </label>
        <label>City
          <input type="text" name="city" autocomplete="address-level2" required />
        </label>
        <label>State
          <select name="state" id="state" autocomplete="address-level1" required>
            <option value="">Selectâ€¦</option>
            <option>AL</option><option>AK</option><option>AZ</option><option>AR</option>
            <option>CA</option><option>CO</option><option>CT</option><option>DE</option>
            <option>FL</option><option>GA</option><option>HI</option><option>ID</option>
            <option>IL</option><option>IN</option><option>IA</option><option>KS</option>
            <option>KY</option><option>LA</option><option>ME</option><option>MD</option>
            <option>MA</option><option>MI</option><option>MN</option><option>MS</option>
            <option>MO</option><option>MT</option><option>NE</option><option>NV</option>
            <option>NH</option><option>NJ</option><option>NM</option><option>NY</option>
            <option>NC</option><option>ND</option><option>OH</option><option>OK</option>
            <option>OR</option><option>PA</option><option>RI</option><option>SC</option>
            <option>SD</option><option>TN</option><option>TX</option><option>UT</option>
            <option>VT</option><option>VA</option><option>WA</option><option>WV</option>
            <option>WI</option><option>WY</option>
          </select>
        </label>
        <label>ZIP Code
          <input type="text" name="zip" inputmode="numeric" autocomplete="postal-code"
                 maxlength="10" pattern="^\d{5}(-\d{4})?$" required />
        </label>
        <label>Phone (optional)
          <input type="tel" name="phone" inputmode="tel" autocomplete="tel" />
        </label>

        <div id="card-container"></div>
        <button id="pay-button" type="button">ðŸ”’ Pay Now</button>
        <div id="status"></div>
      </div>

      <!-- right column -->
      <div id="summary">
        <p>Subtotal: <strong id="subtotal">$0.00</strong></p>

        <!-- Promo UI -->
        <div class="promo-row">
          <input id="promoInput" type="text" placeholder="Promo code (optional)" aria-label="Promo code">
          <button type="button" id="applyPromo" style="padding:.6rem 1rem;">Apply</button>
        </div>
        <small id="promoStatus" style="color:#666;"></small>

        <p id="discountRow" style="display:none;">Promo Discount: <strong id="discountAmount">-$0.00</strong></p>

        <p>Estimated Tax: <strong id="tax">$0.00</strong></p>
        <small id="tax-note" style="color:#666;">Enter your state & ZIP to see tax and shipping.</small>

        <p>Shipping: <strong id="shipping">$0.00</strong></p>
        <small style="color:#666;">Standard (10â€“14 Days)<br/>Time includes creating + shipping combined.</small>

        <p><strong>Total: <span id="total">$0.00</span></strong></p>
      </div>
    </form>

    <div class="square-footer">
      Payments securely processed by <strong>Square</strong>.
      <p>
        Your information may be saved to a Square Pay account. By continuing, you agree to Squareâ€™s
        <a href="https://squareup.com/us/en/legal/general/square-pay-tos" target="_blank" rel="noopener">Terms of Service</a>
        and acknowledge the
        <a href="https://squareup.com/us/en/legal/general/privacy" target="_blank" rel="noopener">Privacy Policy</a>.
      </p>
    </div>
  </div>

  <!-- Progress overlay with step badges (unchanged) -->
  <div id="busy" class="busy-overlay" aria-live="polite" aria-atomic="true" hidden>
    <div class="busy-box">
      <div class="busy-head">
        <div class="spinner" aria-hidden="true"></div>
        <div>Processing your orderâ€¦</div>
      </div>
      <div id="busySteps" class="steps" role="status" aria-live="polite">
        <div class="step" data-step="validate"><span class="dot"></span><span class="txt">Checking details</span></div>
        <div class="step" data-step="tokenize"><span class="dot"></span><span class="txt">Tokenizing card</span></div>
        <div class="step" data-step="submit"><span class="dot"></span><span class="txt">Submitting payment</span></div>
        <div class="step" data-step="done"><span class="dot"></span><span class="txt">Payment complete (redirecting)</span></div>
      </div>
    </div>
  </div>

<script src="/js/site.js" defer></script>
</body>
</html>
